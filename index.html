<!DOCTYPE html>

<html>

<head>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>



</head>



<div id="container" style="width: 100%;"></div>
<div style="display: flex; flex-direction: column;">
  <a id="Mon offre"></a>
  <div id="Mon offre" style="padding: 45px; display: flex; flex-direction: row; padding: 25 px;">
    <iframe id="inlineFrameExample" title="Inline Frame Example" width="300" height="200" style="margin-right: 45px;"
      src="https://www.openstreetmap.org/export/embed.html?bbox=-0.004017949104309083%2C51.47612752641776%2C0.00030577182769775396%2C51.478569861898606&layer=mapnik">
    </iframe>
    <div>
      <h1>Mon Offres</h1>
      <p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
        laborum</p>
    </div>
  </div>

  <a id="Ma communauté"></a>
  <div id="Ma communauté" style="padding: 45px; display: flex; flex-direction: row; padding: 25 px;">
    <iframe id="inlineFrameExample" title="Inline Frame Example" width="300" height="200" style="margin-right: 45px;"
      src="https://www.openstreetmap.org/export/embed.html?bbox=-0.004017949104309083%2C51.47612752641776%2C0.00030577182769775396%2C51.478569861898606&layer=mapnik">
    </iframe>
    <div>
      <h1>Ma communauté</h1>
      <p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
        laborum</p>
    </div>
  </div>

  <a id="Mon environnment"></a>
  <div id="Mon environnment" style="padding: 45px; display: flex; flex-direction: row; padding: 25 px;">
    <iframe id="inlineFrameExample" title="Inline Frame Example" width="300" height="200" style="margin-right: 45px;"
      src="https://www.openstreetmap.org/export/embed.html?bbox=-0.004017949104309083%2C51.47612752641776%2C0.00030577182769775396%2C51.478569861898606&layer=mapnik">
    </iframe>
    <div>
      <h1>Mon environnment</h1>
      <p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
        laborum</p>
    </div>
  </div>

  <a id="Mes Projets"></a>
  <div id="Mes Projets" style="padding: 45px; display: flex; flex-direction: row; padding: 25 px;">

    <iframe id="inlineFrameExample" title="Inline Frame Example" width="300" height="200" style="margin-right: 45px;"
      src="https://www.openstreetmap.org/export/embed.html?bbox=-0.004017949104309083%2C51.47612752641776%2C0.00030577182769775396%2C51.478569861898606&layer=mapnik">
    </iframe>
    <div>
      <h1>Mes Projets</h1>
      <p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
        magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
        pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est
        laborum</p>
    </div>
  </div>
    <h2 style="width: 50%;text-align: center;margin-left: auto; margin-right: auto;"">Section 1.10.32 of "de Finibus Bonorum et Malorum", written by Cicero in
      45 BC</h2>
    <p style="width: 50%; font-size: medium;text-align: center;margin-left: auto; margin-right: auto;"">
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
      magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
      consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem
      aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo
      enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui
      ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur,
      adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat
      voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut
      aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil
      molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
      magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
      consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem
      aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo
      enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui
      ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur,
      adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat
      voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut
      aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil
      molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur
    </p>
  </div>
</div>

<script type="text/javascript">

  $(function () {



    var popay_data = [
      {
        "name": "Mon offre",
        "note": 4,
        'color': '#0000ff',
        "thematiques":
          [
            { "ele": "Mon offre en quelques mots", "val": 1 },
            { "ele": "Mes innovations durables", "val": 1 },
            { "ele": "Mes défis", "val": 1 },
            { "ele": "Mes Tarifs", "val": 1 },
            { "ele": "Mon offre 5", "val": 1 }
          ]

      },
      {
        "name": "Ma communauté",
        "note": 5,
        'color': '#cc9900',
        "thematiques":
          [
            { "ele": "Mes engagements pour ma communauté", "val": 1 },
            { "ele": "Mes collaborateurs ", "val": 1 },
            { "ele": "Mes produits", "val": 1 },
            { "ele": "Mon utilisation du vrac", "val": 1 },
            { "ele": "Mon plastique", "val": 1 },
            { "ele": "Mes Livraisons", "val": 1 }

          ]
      },
      {
        "name": "Mon environnment",
        "note": 3,
        'color': '#006600',
        "thematiques":
          [
            { "ele": "Mon inscription dans le paysage", "val": 1 },
            { "ele": "Ma contribution à l'environnement ", "val": 1 },
            { "ele": "Mon offre découverte", "val": 1 },
            { "ele": "Mon environnement 4", "val": 1 },
            { "ele": "Mon environnement 5", "val": 1 }

          ]
      },
      {
        "name": "Mes Projets",
        "note": 3,
        'color': '#990033',
        "thematiques":
          [
            { "ele": "Projet 1", "val": 1 },
            { "ele": "Projet 2", "val": 1 },
            { "ele": "Projet 3", "val": 1 },
            { "ele": "Projet 3", "val": 1 },
            { "ele": "Projet 3", "val": 1 }
          ]
      },




    ];



    var classificationData = [], elementData = [];
    var total = 0


    for (let i = 0; i < popay_data.length; i += 1) {
      for (let y = 0, total = 0; y < popay_data[i].note; y += 1) {

        elementData.push({ "name": popay_data[i].thematiques[y].ele, "y": popay_data[i].thematiques[y].val });

        total += popay_data[i].thematiques[y].val;

      };


      console.log('total de ' + popay_data[i].name + ' est ' + total)
      classificationData[i] = {

        name: popay_data[i].name,

        y: popay_data[i].note,

        color: popay_data[i].color,

        nrElements: popay_data[i].note

      };



    }

    console.log(elementData)
    console.log(classificationData)



    // Add the color to the 2nd level array, a brightness variation for each base color (per classification)

    for (var i = 0, e = 0; i < popay_data.length; i += 1) {

      var elementsOfClass = classificationData[i].nrElements;



      for (var j = 0; j < elementsOfClass; j += 1) {

        // create n brightness adjustements, within the 25 pct range.

        var brightness = (1 - ((elementsOfClass - j) / elementsOfClass)) / 4;

        elementData[e].color = Highcharts.Color(classificationData[i].color).brighten(brightness).get();

        e = e + 1;

      }

    };



    // Create the chart

    $('#container').highcharts({

      chart: {
        type: 'pie',
        height: 600
      },



      title: { text: 'Mon engagement' },

      plotOptions: {

        pie: {

          center: ['50%', '50%'],

          startAngle: -90 // showing data starts at -90 degrees for both series

        },
        series: {
          cursor: 'pointer',
          point: {
            events: {
              click: function () {
                location.href = '#' +
                  this.options.name;
              }
            }
          }
        }
      },

      series: [{

        name: 'Total', // shown in the tooltip

        data: classificationData,

        size: '60%', // inner donut

        dataLabels: {

          color: 'white',

          style: { "textShadow": "0 0 0 contrast, 0 0 0 contrast" },

          distance: -50

        }
      }, {

        name: popay_data.currency, // shown in the tooltip

        data: elementData,

        size: '100%',

        innerSize: '65%' // a little more then the 60% of the first serie

      }]

    });

  });



</script>

</body>

</html>